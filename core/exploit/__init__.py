#!/usr/bin/env python3
"""
漏洞利用模块 - Exploit Module
纯 Python 实现，无需外部工具依赖

提供:
- ExploitEngine: 自动漏洞利用引擎
- PureSQLiEngine: SQL注入利用引擎
- PurePortScanner: 端口扫描器
"""

from .pure_sqli import (
    PureSQLiEngine,
    SQLiType,
    SQLiResult,
    DBType,
    InjectionPoint,
    PayloadGenerator,
    WAFBypass,
    detect_sqli,
    exploit_sqli,
)
from .pure_scanner import (
    PurePortScanner,
    ServiceProbe,
    PortState,
    PortResult,
    HostResult,
    ServiceInfo,
    UDPScanner,
    scan_ports,
    scan_network,
    quick_scan,
)

# 新增：自动化利用引擎
from .engine import (
    ExploitEngine,
    ExploitResult,
    ExploitStatus,
    ExploitType,
    BaseExploiter,
    ShellInfo,
    AccessInfo,
    FileInfo,
    ExploitStrategyRegistry,
    register_exploiter,
    exploit_vulnerability,
    exploit_cve,
)

# 导入利用器模块以触发注册
from . import exploiters

# 新增：利用编排器
from .orchestrator import (
    ExploitOrchestrator,
    OrchestratedExploitResult,
    OrchestrationStrategy,
    RankedDetection,
    orchestrate_exploits,
    exploit_with_retry,
)

__all__ = [
    # ExploitEngine (新增)
    'ExploitEngine',
    'ExploitResult',
    'ExploitStatus',
    'ExploitType',
    'BaseExploiter',
    'ShellInfo',
    'AccessInfo',
    'FileInfo',
    'ExploitStrategyRegistry',
    'register_exploiter',
    'exploit_vulnerability',
    'exploit_cve',
    # SQLi Engine
    'PureSQLiEngine',
    'SQLiType',
    'SQLiResult',
    'DBType',
    'InjectionPoint',
    'PayloadGenerator',
    'WAFBypass',
    'detect_sqli',
    'exploit_sqli',
    # Port Scanner
    'PurePortScanner',
    'ServiceProbe',
    'PortState',
    'PortResult',
    'HostResult',
    'ServiceInfo',
    'UDPScanner',
    'scan_ports',
    'scan_network',
    'quick_scan',
    # Orchestrator (新增)
    'ExploitOrchestrator',
    'OrchestratedExploitResult',
    'OrchestrationStrategy',
    'RankedDetection',
    'orchestrate_exploits',
    'exploit_with_retry',
]
